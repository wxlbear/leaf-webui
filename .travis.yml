language: node_js

node_js:
  - '8'

cache:
  directories:
    - node_modules

install:
  - npm install

script:
  - npm run build

after_script:
  - cd ./dist
  - git init
  - git config user.name "wxlbear"
  - git config user.email "1581997923@qq.com"
  - git add .
  - git commit -m "static page"
  - git push --force --quiet "https://${LEAF_TOKEN}@${LEAF_REF}" master:${P_BRANCH}
# after_success:
#   - echo "${SFTP_KEY}" | base64 --decode >/tmp/sftp_rsa
#   - curl --ftp-create-dirs
#     -T .
#     --key /tmp/sftp_rsa
#     sftp://${SFTP_USER}:${SFTP_PASSWORD}@118.24.64.174/root/deploy
